<div class="overview-container">
  <!-- Header -->
  <div class="header-section">
    <div class="header-content">
      <h1 class="page-title">
        <i class="bi bi-speedometer2 me-2"></i>
        Dashboard Overview
      </h1>
      <p class="page-subtitle">Welcome back! Here's what's happening in your system.</p>
    </div>
    <div class="header-actions">
      <button class="btn modern-btn" (click)="refreshData()" [disabled]="loading">
        <i class="bi bi-arrow-clockwise me-2"></i>
        {{ loading ? 'Refreshing...' : 'Refresh' }}
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-container">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p class="mt-3 text-muted">Loading dashboard data...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !loading" class="error-container">
    <div class="alert alert-danger" role="alert">
      <i class="bi bi-exclamation-triangle me-2"></i>
      {{ error }}
      <button class="btn btn-sm btn-outline-danger ms-3" (click)="refreshData()">
        Try Again
      </button>
    </div>
  </div>

  <!-- Dashboard Content -->
  <div *ngIf="!loading && !error" class="dashboard-content">
    <!-- Statistics Cards -->
    <div class="stats-grid">
      <!-- Total Products -->
      <div class="stat-card">
        <div class="stat-content">
          <div class="stat-info">
            <h3 class="stat-number">{{ stats.totalProducts }}</h3>
            <p class="stat-label">Total Products</p>
            <div class="stat-change positive">
              <i class="bi bi-arrow-up"></i>
              <span>Active in catalog</span>
            </div>
          </div>
          <div class="stat-icon">
            <i class="bi bi-box-seam"></i>
          </div>
        </div>
        <div class="stat-progress">
          <div class="progress-circle" [style.--progress]="85">
            <div class="circle">
              <div class="inside-circle">
                <span class="progress-text">85%</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Pending Products -->
      <div class="stat-card">
        <div class="stat-content">
          <div class="stat-info">
            <h3 class="stat-number">{{ stats.pendingProducts }}</h3>
            <p class="stat-label">Pending Products</p>
            <div class="stat-change warning">
              <i class="bi bi-exclamation-triangle"></i>
              <span>Need approval</span>
            </div>
          </div>
          <div class="stat-icon">
            <i class="bi bi-clock-history"></i>
          </div>
        </div>
        <div class="stat-progress">
          <div class="progress-circle" [style.--progress]="stats.pendingProducts > 0 ? 60 : 100">
            <div class="circle">
              <div class="inside-circle">
                <span class="progress-text">{{ stats.pendingProducts > 0 ? '60%' : '100%' }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Total Orders -->
      <div class="stat-card">
        <div class="stat-content">
          <div class="stat-info">
            <h3 class="stat-number">{{ stats.totalOrders }}</h3>
            <p class="stat-label">Total Orders</p>
            <div class="stat-change positive">
              <i class="bi bi-arrow-up"></i>
              <span>All time</span>
            </div>
          </div>
          <div class="stat-icon">
            <i class="bi bi-cart-check"></i>
          </div>
        </div>
        <div class="stat-progress">
          <div class="progress-circle" [style.--progress]="75">
            <div class="circle">
              <div class="inside-circle">
                <span class="progress-text">75%</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Total Revenue -->
      <div class="stat-card">
        <div class="stat-content">
          <div class="stat-info">
            <h3 class="stat-number">{{ formatCurrency(stats.totalRevenue) }}</h3>
            <p class="stat-label">Total Revenue</p>
            <div class="stat-change positive">
              <i class="bi bi-arrow-up"></i>
              <span>All time</span>
            </div>
          </div>
          <div class="stat-icon">
            <i class="bi bi-currency-dollar"></i>
          </div>
        </div>
        <div class="stat-progress">
          <div class="progress-circle" [style.--progress]="90">
            <div class="circle">
              <div class="inside-circle">
                <span class="progress-text">90%</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Total Customers -->
      <div class="stat-card">
        <div class="stat-content">
          <div class="stat-info">
            <h3 class="stat-number">{{ stats.totalCustomers }}</h3>
            <p class="stat-label">Total Customers</p>
            <div class="stat-change positive">
              <i class="bi bi-arrow-up"></i>
              <span>Registered users</span>
            </div>
          </div>
          <div class="stat-icon">
            <i class="bi bi-people"></i>
          </div>
        </div>
        <div class="stat-progress">
          <div class="progress-circle" [style.--progress]="80">
            <div class="circle">
              <div class="inside-circle">
                <span class="progress-text">80%</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Active Maintenance -->
      <div class="stat-card">
        <div class="stat-content">
          <div class="stat-info">
            <h3 class="stat-number">{{ stats.activeMaintenanceRequests }}</h3>
            <p class="stat-label">Active Maintenance</p>
            <div class="stat-change info">
              <i class="bi bi-tools"></i>
              <span>In progress</span>
            </div>
          </div>
          <div class="stat-icon">
            <i class="bi bi-wrench"></i>
          </div>
        </div>
        <div class="stat-progress">
          <div class="progress-circle" [style.--progress]="70">
            <div class="circle">
              <div class="inside-circle">
                <span class="progress-text">70%</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Additional Stats Row -->
    <div class="additional-stats">
      <div class="row g-4">
        <div class="col-md-3">
          <div class="mini-stat-card">
            <div class="mini-stat-icon">
              <i class="bi bi-building"></i>
            </div>
            <div class="mini-stat-info">
              <h4>{{ stats.totalTechCompanies }}</h4>
              <p>Tech Companies</p>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="mini-stat-card">
            <div class="mini-stat-icon">
              <i class="bi bi-truck"></i>
            </div>
            <div class="mini-stat-info">
              <h4>{{ stats.totalDeliveryPersons }}</h4>
              <p>Delivery Persons</p>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="mini-stat-card">
            <div class="mini-stat-icon">
              <i class="bi bi-box-arrow-right"></i>
            </div>
            <div class="mini-stat-info">
              <h4>{{ stats.activeDeliveries }}</h4>
              <p>Active Deliveries</p>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="mini-stat-card">
            <div class="mini-stat-icon">
              <i class="bi bi-percent"></i>
            </div>
            <div class="mini-stat-info">
              <h4>{{ stats.totalCommissions }}</h4>
              <p>Total Commissions</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Recent Activity Section -->
    <div class="recent-activity-section">
      <div class="row g-4">
        <!-- Recent Orders -->
        <div class="col-lg-6">
          <div class="activity-card">
            <div class="card-header">
              <h5 class="card-title">
                <i class="bi bi-clock-history me-2"></i>
                Recent Orders
              </h5>
              <a routerLink="/dashboard/orders" class="btn btn-sm btn-outline-primary">
                View All
              </a>
            </div>
            <div class="card-body">
              <div *ngIf="stats.recentOrders.length === 0" class="empty-state">
                <i class="bi bi-inbox display-4 text-muted"></i>
                <p class="text-muted">No recent orders</p>
              </div>
              <div *ngFor="let order of stats.recentOrders" class="activity-item">
                <div class="activity-icon">
                  <i class="bi bi-cart-check"></i>
                </div>
                <div class="activity-content">
                  <h6 class="activity-title">Order #{{ order.id.slice(0, 8) }}</h6>
                  <p class="activity-subtitle">{{ order.customerName }}</p>
                  <div class="activity-meta">
                    <span class="activity-date">{{ formatDate(order.orderDate) }}</span>
                    <span class="activity-amount">{{ formatCurrency(order.totalAmount) }}</span>
                  </div>
                </div>
                <div class="activity-status">
                  <span class="badge" [ngClass]="'bg-' + getStatusColor(order.status)">
                    <i class="bi me-1" [ngClass]="getStatusIcon(order.status)"></i>
                    {{ order.status }}
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Recent Maintenance -->
        <div class="col-lg-6">
          <div class="activity-card">
            <div class="card-header">
              <h5 class="card-title">
                <i class="bi bi-tools me-2"></i>
                Recent Maintenance
              </h5>
              <a routerLink="/dashboard/maintenance-requests" class="btn btn-sm btn-outline-primary">
                View All
              </a>
            </div>
            <div class="card-body">
              <div *ngIf="stats.recentMaintenance.length === 0" class="empty-state">
                <i class="bi bi-wrench display-4 text-muted"></i>
                <p class="text-muted">No recent maintenance requests</p>
              </div>
              <div *ngFor="let maintenance of stats.recentMaintenance" class="activity-item">
                <div class="activity-icon">
                  <i class="bi bi-wrench"></i>
                </div>
                <div class="activity-content">
                  <h6 class="activity-title">{{ maintenance.serviceType }}</h6>
                  <p class="activity-subtitle">{{ maintenance.customerName }} → {{ maintenance.techCompanyName }}</p>
                  <div class="activity-meta">
                    <span class="activity-product">{{ maintenance.productName }}</span>
                  </div>
                </div>
                <div class="activity-status">
                  <span class="badge" [ngClass]="'bg-' + getStatusColor(maintenance.status)">
                    <i class="bi me-1" [ngClass]="getStatusIcon(maintenance.status)"></i>
                    {{ maintenance.status }}
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Top Products Section -->
    <div class="top-products-section">
      <div class="section-header">
        <h4 class="section-title">
          <i class="bi bi-star me-2"></i>
          Top Products
        </h4>
        <a routerLink="/dashboard/products" class="btn btn-sm btn-outline-primary">
          View All Products
        </a>
      </div>
      <div class="products-grid">
        <div *ngFor="let product of stats.topProducts" class="product-card">
          <div class="product-image">
            <img [src]="product.imageUrl || 'assets/Images/placeholder.png'" 
                 [alt]="product.name"
                 (error)="onImageError($event)">
          </div>
          <div class="product-info">
            <h6 class="product-name">{{ product.name }}</h6>
            <p class="product-company">{{ product.techCompanyName }}</p>
            <div class="product-price">{{ formatCurrency(product.price) }}</div>
          </div>
          <div class="product-actions">
            <a [routerLink]="['/dashboard/edit-product', product.id]" 
               class="btn btn-sm btn-outline-primary">
              <i class="bi bi-pencil"></i>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div> 